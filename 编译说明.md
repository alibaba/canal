# 如何编译

## 修改POM

client-adapter.escore的pom.xml的关于druid的配置，需要设置scope为provider
之前的配置是:

```xml
<dependency>
  <groupId>com.alibaba</groupId>
  <artifactId>druid</artifactId>
</dependency>
```

修改之后的配置为：

```xml
<dependency>
  <groupId>com.alibaba</groupId>
  <artifactId>druid</artifactId>
  <scope>provided</scope>//加上这行配置，让es的xxxx-with-dependency.jar不包含druid相关包
</dependency>
```

## 批量修改版本

```shell
mvn versions:set -DnewVersion=1.1.5
mvn versions:commit
```

## 执行编译

```shell
mvn clean compile package -Dmaven.test.skip=true
```

## 使用jdk 11

deployer和adapter启动脚本需要移除startup.sh中的
-XX:+UseCMSCompactAtFullCollection -XX:+UseFastAccessorMethods

adapter/conf/application.xml关于srcDataSource

srcDataSources:
    defaultDS:
      url: jdbc:mysql://xxx.xxx.xxx.xxx:3306/test?useUnicode=true&characterEncoding=utf8&autoReconnect=true&useSSL=false

customer.yml

```yml

dataSourceKey: defaultDS
destination: example
groupId: g1
esMapping:
  _index: customer
  _type: _doc # 虽说es7取消了这玩意，但是在修改该文件后，假如没有这玩意，adapter会报错
  _id: id
  sql: "select t.id, t.name, t.email from customer t"
  commitBatch: 10
```
